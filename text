*** Keywords ***
Acquire Token With Error Handling
    Log To Console    \n--- Acquiring Token ---
    ${status}    ${token}=    Run Keyword And Ignore Error    Get Token
    ${token}=    Set Variable If    '${status}'=='PASS'    ${token}    NONE
    Set Suite Variable    ${TOKEN}    ${token}
    Run Keyword If    '${status}'=='FAIL'    Log    Token fetch failed, continuing without token.
    Log To Console    TOKEN = ${TOKEN}

Get Token
    Create Session    auth    https://api.example.com    verify=False
    ${resp}=    GET On Session    auth    /token
    Should Be Equal As Integers    ${resp.status_code}    200
    ${json}=    Evaluate    resp.json()    resp=${resp}
    RETURN    ${json["token"]}






*** Settings ***
Library    RequestsLibrary
Library    BuiltIn
Suite Setup    Acquire Token With Error Handling
Resource    token_keywords.robot

*** Test Cases ***

Test Case A - Validate Token
    [Documentation]    Test A should run first, but even if it fails, B must run.
    Log To Console    \nRunning Test A...
    Should Not Be Equal    ${TOKEN}    NONE
    Log To Console    Token in Test A: ${TOKEN}

Test Case B - Must Run Always
    [Documentation]    Test B runs even if A fails or token acquisition fails.
    Log To Console    \nRunning Test B...
    Log To Console    Token in Test B: ${TOKEN}
    # Simulated test action
    Log To Console    Test B executed successfully.

